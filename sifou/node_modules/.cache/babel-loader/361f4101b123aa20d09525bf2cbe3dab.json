{"remainingRequest":"E:\\丫丫\\web\\CODE\\blog\\sifou\\node_modules\\babel-loader\\lib\\index.js!E:\\丫丫\\web\\CODE\\blog\\sifou\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\丫丫\\web\\CODE\\blog\\sifou\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\丫丫\\web\\CODE\\blog\\sifou\\src\\pages\\user\\views\\ChatHome.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\丫丫\\web\\CODE\\blog\\sifou\\src\\pages\\user\\views\\ChatHome.vue","mtime":1610954820428},{"path":"E:\\丫丫\\web\\CODE\\blog\\sifou\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\丫丫\\web\\CODE\\blog\\sifou\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\丫丫\\web\\CODE\\blog\\sifou\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\丫丫\\web\\CODE\\blog\\sifou\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubGFzdC1pbmRleC1vZiI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaXRlcmF0b3IiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLml0ZXJhdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLnVybCI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lIjsKaW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiRTovXHU0RTJCXHU0RTJCL3dlYi9DT0RFL2Jsb2cvc2lmb3Uvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiRTovXHU0RTJCXHU0RTJCL3dlYi9DT0RFL2Jsb2cvc2lmb3Uvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwoKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KZnVuY3Rpb24gY3V0SW1hZ2VCYXNlNjQoX3gsIF94MiwgX3gzKSB7CiAgcmV0dXJuIF9jdXRJbWFnZUJhc2UuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKZnVuY3Rpb24gX2N1dEltYWdlQmFzZSgpIHsKICBfY3V0SW1hZ2VCYXNlID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKGZpbGVzLCB3aWR0aCwgcXVhbGl0eSkgewogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgdmFyIGZpbGUgPSBmaWxlc1swXTsKICAgICAgICAgICAgICB2YXIgVVJMID0gd2luZG93LlVSTCB8fCBXaW5kb3cud2Via2l0VVJMOwogICAgICAgICAgICAgIHZhciBibG9iID0gVVJMLmNyZWF0ZU9iamVjdFVSTChmaWxlKTsgLy/ojrflj5blvZPliY3mlofku7bnmoTkuIDkuKrlhoXlrZhVUkwKCiAgICAgICAgICAgICAgdmFyIGJhc2U2NDsKICAgICAgICAgICAgICB2YXIgaW1nID0gbmV3IEltYWdlKCk7CiAgICAgICAgICAgICAgaW1nLnNyYyA9IGJsb2I7CgogICAgICAgICAgICAgIGltZy5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB2YXIgdyA9IHRoaXMud2lkdGg7CiAgICAgICAgICAgICAgICB2YXIgaCA9IHRoaXMuaGVpZ2h0OwogICAgICAgICAgICAgICAgdmFyIHNjYWxlID0gdyAvIGg7CiAgICAgICAgICAgICAgICB3ID0gd2lkdGggfHwgdzsKICAgICAgICAgICAgICAgIGggPSB3IC8gc2NhbGU7CiAgICAgICAgICAgICAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7CiAgICAgICAgICAgICAgICB2YXIgY2FuQ29uID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7CiAgICAgICAgICAgICAgICBjYW52YXMud2lkdGggPSB3OwogICAgICAgICAgICAgICAgY2FudmFzLmhlaWdodCA9IGg7CiAgICAgICAgICAgICAgICBjYW5Db24uZHJhd0ltYWdlKHRoaXMsIDAsIDAsIHcsIGgpOwogICAgICAgICAgICAgICAgdmFyIGV4dCA9IHRoaXMuc3JjLnN1YnN0cmluZyh0aGlzLnNyYy5sYXN0SW5kZXhPZigiLiIpICsgMSkudG9Mb3dlckNhc2UoKTsKICAgICAgICAgICAgICAgIGJhc2U2NCA9IGNhbnZhcy50b0RhdGFVUkwoJ2ltYWdlLycgKyBleHQsIHF1YWxpdHkgfHwgMC44KTsKICAgICAgICAgICAgICAgIHJlcyhiYXNlNjQpOwogICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZSk7CiAgfSkpOwogIHJldHVybiBfY3V0SW1hZ2VCYXNlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCmltcG9ydCBkZWZhdWx0Q29uZmlnIGZyb20gJ0AvY29uZmlnL2NvbmZpZy5kZWZhdWx0JzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJjaGF0SG9tZSIsCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHNvY2tldDogbnVsbCwKICAgICAgbXNnVGV4dDogJycsCiAgICAgIG1lc3NhZ2U6IHsKICAgICAgICB1c2VyTmFtZTogJycsCiAgICAgICAgYXZhdGFyOiAnJywKICAgICAgICBtc2c6IHsKICAgICAgICAgIHR5cGU6ICcnLAogICAgICAgICAgY29udGVudDogJyAnCiAgICAgICAgfQogICAgICB9LAogICAgICB1c2VyRGF0YTogSlNPTi5wYXJzZShzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCd1c2VyRGF0YScpKSwKICAgICAgbXNnTGlzdDogW10KICAgIH07CiAgfSwKICB3YXRjaDogewogICAgdXNlckRhdGE6IHsKICAgICAgaGFuZGxlcjogZnVuY3Rpb24gaGFuZGxlcigpIHsKICAgICAgICB0aGlzLm1lc3NhZ2UudXNlck5hbWUgPSB0aGlzLnVzZXJEYXRhLnVzZXJOYW1lOwogICAgICAgIHRoaXMubWVzc2FnZS5hdmF0YXIgPSB0aGlzLnVzZXJEYXRhLmF2YXRhcjsKICAgICAgfSwKICAgICAgaW1tZWRpYXRlOiB0cnVlCiAgICB9CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgdGhpcy5zb2NrZXQgPSBuZXcgV2ViU29ja2V0KCIiLmNvbmNhdChkZWZhdWx0Q29uZmlnLndzc0FwaVVybCkpOwogICAgdmFyIHZtID0gdGhpczsgLy/miJDlip/ov57mjqXogYrlpKnlrqQKCiAgICB0aGlzLnNvY2tldC5hZGRFdmVudExpc3RlbmVyKCdvcGVuJywgZnVuY3Rpb24gKCkgewogICAgICB2bS4kbWVzc2FnZS5zdWNjZXNzKCfliqDlhaXogYrlpKnlrqQnKTsKICAgIH0pOyAvL+aOpeaUtuS/oeaBrwoKICAgIHRoaXMuc29ja2V0LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgdm0ubXNnTGlzdC5wdXNoKF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgSlNPTi5wYXJzZShldmVudC5kYXRhKSksIHt9LCB7CiAgICAgICAgdHlwZTogJ290aGVyJwogICAgICB9KSk7CiAgICAgIHZtLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgdm0uJHJlZnMuY29udGVudEFyZWEuc2Nyb2xsVG9wID0gdm0uJHJlZnMuY29udGVudEFyZWEuc2Nyb2xsSGVpZ2h0OwogICAgICB9KTsKICAgIH0pOwogIH0sCiAgbWV0aG9kczogewogICAgZ29CYWNrOiBmdW5jdGlvbiBnb0JhY2soKSB7CiAgICAgIHRoaXMuJHJvdXRlci5nbygtMSk7CiAgICB9LAogICAgc2VuZEltZzogZnVuY3Rpb24gc2VuZEltZygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIGN1dEltYWdlQmFzZTY0KHRoaXMuJHJlZnMuc2VsZWN0SW1nLmZpbGVzLCA0MDAsIDAuNikudGhlbihmdW5jdGlvbiAocnMpIHsKICAgICAgICBfdGhpcy5tZXNzYWdlLm1zZy50eXBlID0gJ2ltZyc7CiAgICAgICAgX3RoaXMubWVzc2FnZS5tc2cuY29udGVudCA9IHJzOwoKICAgICAgICBfdGhpcy5zb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeShfdGhpcy5tZXNzYWdlKSk7CgogICAgICAgIF90aGlzLm1zZ0xpc3QucHVzaChfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoX3RoaXMubWVzc2FnZSkpKSwge30sIHsKICAgICAgICAgIHR5cGU6ICdtZScKICAgICAgICB9KSk7CgogICAgICAgIF90aGlzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpcy4kcmVmcy5jb250ZW50QXJlYS5zY3JvbGxUb3AgPSBfdGhpcy4kcmVmcy5jb250ZW50QXJlYS5zY3JvbGxIZWlnaHQ7CiAgICAgICAgfSk7CgogICAgICAgIF90aGlzLm1lc3NhZ2UubXNnLnR5cGUgPSAnJzsKICAgICAgICBfdGhpcy5tZXNzYWdlLm1zZy5jb250ZW50ID0gJyAgJzsKICAgICAgfSk7CiAgICB9LAogICAgc2VuZFRleHQ6IGZ1bmN0aW9uIHNlbmRUZXh0KCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIGlmICghdGhpcy5tc2dUZXh0KSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCfkuI3og73lj5HpgIHnqbrmtojmga8nKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMubWVzc2FnZS5tc2cudHlwZSA9ICd0ZXh0JzsKICAgICAgdGhpcy5tZXNzYWdlLm1zZy5jb250ZW50ID0gdGhpcy5tc2dUZXh0OwogICAgICB0aGlzLnNvY2tldC5zZW5kKEpTT04uc3RyaW5naWZ5KHRoaXMubWVzc2FnZSkpOyAvL+WPkemAgeS/oeaBrwoKICAgICAgdGhpcy5tc2dUZXh0ID0gJyc7CiAgICAgIHRoaXMubXNnTGlzdC5wdXNoKF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLm1lc3NhZ2UpKSksIHt9LCB7CiAgICAgICAgdHlwZTogJ21lJwogICAgICB9KSk7CiAgICAgIHRoaXMuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczIuJHJlZnMuY29udGVudEFyZWEuc2Nyb2xsVG9wID0gX3RoaXMyLiRyZWZzLmNvbnRlbnRBcmVhLnNjcm9sbEhlaWdodDsKICAgICAgfSk7CiAgICAgIHRoaXMubWVzc2FnZS5tc2cudHlwZSA9ICcnOwogICAgICB0aGlzLm1lc3NhZ2UubXNnLmNvbnRlbnQgPSAnICAnOwogICAgfQogIH0KfTs="},{"version":3,"sources":["ChatHome.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div>\r\n    <el-page-header @back=\"goBack\">\r\n    </el-page-header>\r\n    <div class=\"chat-wrapper\">\r\n      <div class=\"content-area\" ref='contentArea'>\r\n      <div class=\"msg-box\"  v-for='(item, index) in msgList' :key='index'>\r\n        <div\r\n        :style=\"{\r\n          float:item.type === 'me' ? 'right' : 'left',\r\n          padding:'10px'\r\n        }\"\r\n        >\r\n        <div \r\n        :style=\"{\r\n          float:item.type === 'me' ? 'right' : 'left'\r\n        }\">\r\n          <el-avatar :size=\"40\" :src='item.avatar' style=\"display: block;margin: 0 auto\"></el-avatar>\r\n          <span style='font-size: 12px;'>{{item.userName}}</span>\r\n        </div>\r\n        <el-card\r\n        :style=\"{\r\n          float:item.type === 'me' ? 'right' : 'left',\r\n          margin:'0 10px'\r\n        }\">\r\n          <span v-if=\"item.msg.type==='text'\">{{item.msg.content}}</span>\r\n          <el-image v-else :src=\"item.msg.content\"></el-image>\r\n        </el-card>\r\n        \r\n        </div>\r\n      </div>\r\n      </div>\r\n      <div class=\"tool-bar\">\r\n        <el-row style=\" text-align: center;box-shadow: 0 0px 10px 1px #ccc\">\r\n          <el-col :span='2' style=\"line-height: 40px; cursor: pointer;\" class=\"select-img\">\r\n            <i class=\"el-icon-picture-outline\" style=\"cursor: pointer;\"></i>\r\n            <input @change='sendImg' type=\"file\" ref='selectImg' style=\"position: absolute;z-index: 10;top: 0;left: 0;opacity: 0;\">\r\n          </el-col>\r\n          <el-col :span='20'>\r\n            <el-input v-model=\"msgText\" @keypress.enter.native='sendText'></el-input>\r\n          </el-col>\r\n          <el-col :span='2'>\r\n            <el-button type=\"text\" icon='el-icon-s-promotion' @click='sendText'></el-button>\r\n          </el-col>\r\n        </el-row>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  async function cutImageBase64(files, width, quality){\r\n    return new Promise((res => {\r\n      const file = files[0]\r\n      let URL = window.URL || Window.webkitURL\r\n      let blob = URL.createObjectURL(file) //获取当前文件的一个内存URL\r\n      let base64\r\n      const img = new Image()\r\n      img.src = blob\r\n      img.onload = function(){\r\n        let w = this.width\r\n        let h = this.height\r\n        let scale = w / h\r\n        w = width || w\r\n        h = w / scale\r\n        const canvas = document.createElement('canvas')\r\n        const canCon = canvas.getContext('2d')\r\n        canvas.width = w \r\n        canvas.height = h\r\n        canCon.drawImage(this, 0, 0, w, h)\r\n        let ext = this.src.substring(this.src.lastIndexOf(\".\") + 1).toLowerCase();\r\n        base64 = canvas.toDataURL('image/'+ext, quality || 0.8)\r\n        res(base64)\r\n      }\r\n    }))\r\n\r\n  }\r\n  import defaultConfig from '@/config/config.default'\r\n  export default {\r\n    name: \"chatHome\",\r\n    data(){\r\n      return {\r\n        socket:null,\r\n        msgText:'',\r\n        message:{\r\n          userName:'',\r\n          avatar:'',\r\n          msg:{\r\n            type:'',\r\n            content:' '\r\n          }\r\n        },\r\n        userData:JSON.parse(sessionStorage.getItem('userData')),\r\n        msgList:[]\r\n      }\r\n    },\r\n    watch:{\r\n      userData:{\r\n        handler(){\r\n          this.message.userName = this.userData.userName\r\n          this.message.avatar = this.userData.avatar\r\n        },\r\n        immediate:true\r\n      }\r\n    },\r\n    mounted(){\r\n      this.socket = new WebSocket(`${defaultConfig.wssApiUrl}`)\r\n      let vm = this\r\n\r\n      //成功连接聊天室\r\n      this.socket.addEventListener('open',function(){\r\n        vm.$message.success('加入聊天室')\r\n      })\r\n\r\n      //接收信息\r\n      this.socket.addEventListener('message',function(event){\r\n        vm.msgList.push({\r\n          ...JSON.parse(event.data),\r\n          type:'other'\r\n        })\r\n        vm.$nextTick(() => {\r\n          vm.$refs.contentArea.scrollTop = vm.$refs.contentArea.scrollHeight\r\n        })\r\n      })\r\n    },\r\n    methods:{\r\n      goBack(){\r\n        this.$router.go(-1)\r\n      },\r\n      sendImg(){\r\n        cutImageBase64(this.$refs.selectImg.files, 400, 0.6).then(rs => {\r\n          this.message.msg.type = 'img'\r\n          this.message.msg.content = rs\r\n          this.socket.send(JSON.stringify(this.message))\r\n          this.msgList.push({\r\n            ...JSON.parse(JSON.stringify(this.message)),\r\n            type:'me'\r\n          })\r\n          this.$nextTick(() => {\r\n            this.$refs.contentArea.scrollTop = this.$refs.contentArea.scrollHeight\r\n          })\r\n          this.message.msg.type = ''\r\n          this.message.msg.content = '  '\r\n        })\r\n      },\r\n      sendText(){\r\n        if(!this.msgText){\r\n          this.$message.warning('不能发送空消息')\r\n          return \r\n        }\r\n        this.message.msg.type = 'text'\r\n        this.message.msg.content = this.msgText\r\n        this.socket.send(JSON.stringify(this.message)) //发送信息\r\n        this.msgText = ''\r\n        this.msgList.push({\r\n          ...JSON.parse(JSON.stringify(this.message)),\r\n          type:'me'\r\n        })\r\n        this.$nextTick(() => {\r\n          this.$refs.contentArea.scrollTop = this.$refs.contentArea.scrollHeight\r\n        })\r\n        this.message.msg.type = ''\r\n        this.message.msg.content = '  '\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n  .chat-wrapper{\r\n    position: relative;\r\n    width: 100%;\r\n    height: calc(100vh - 24px);\r\n  }\r\n  .content-area{\r\n    height:calc(100% - 40px);\r\n    overflow-y: auto;\r\n  }\r\n  .tool-bar{\r\n    position:absolute;\r\n    left: 0;\r\n    bottom: 0;\r\n    box-sizing: border-box;\r\n    width: 100%;\r\n    height:40px;\r\n    background-color: #fff;\r\n  }\r\n  .select-img:hover{\r\n    color:#409EFF\r\n  }\r\n  .msg-box::after{\r\n    content:'';\r\n    display: block;\r\n    clear:both\r\n  }\r\n  .el-card__body{\r\n    padding:10px\r\n  }\r\n</style>\r\n<!--\r\n  保持长连接\r\n    服务器上主动给用户发送信息\r\n    socket(套接字)\r\n\r\n  轮询：\r\n    每隔一段时间就向后端发送请求\r\n\r\n-->"],"sourceRoot":"src/pages/user/views"}]}