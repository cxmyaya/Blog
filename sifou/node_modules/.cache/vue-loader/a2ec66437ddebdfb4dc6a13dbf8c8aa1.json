{"remainingRequest":"E:\\丫丫\\web\\CODE\\blog\\sifou\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\丫丫\\web\\CODE\\blog\\sifou\\src\\components\\Global-Comment.vue?vue&type=style&index=0&id=2cec95c5&scoped=true&lang=css&","dependencies":[{"path":"E:\\丫丫\\web\\CODE\\blog\\sifou\\src\\components\\Global-Comment.vue","mtime":1609082113020},{"path":"E:\\丫丫\\web\\CODE\\blog\\sifou\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\丫丫\\web\\CODE\\blog\\sifou\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\丫丫\\web\\CODE\\blog\\sifou\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"E:\\丫丫\\web\\CODE\\blog\\sifou\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\丫丫\\web\\CODE\\blog\\sifou\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouY29tbWVudC1jYXJkewogIHBhZGRpbmc6MjBweDsKICBib3gtc2hhZG93OiAwIDJweCA0cHggcmdiYSgwLDAsMCwuNSk7Cn0K"},{"version":3,"sources":["Global-Comment.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuNA;AACA;AACA;AACA","file":"Global-Comment.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <div>\r\n    <div\r\n      v-for='(commentItem, index) in localComment'\r\n      :key='index'\r\n      class=\"comment-card\"\r\n      style=\"margin-bottom: 20px;\"\r\n    >\r\n      <el-row :gutter=\"10\" >\r\n        <el-col :span=\"2\">\r\n          <el-avatar :src='commentItem.userData.avatar' size='large'></el-avatar>\r\n        </el-col>\r\n        <el-col :span=\"6\" style=\"font-size: 12px;\">\r\n          <span>{{commentItem.userData.userName}}</span>\r\n          <br>\r\n          <span>{{commentItem.lastModified | transformTime}}</span>\r\n        </el-col>\r\n      </el-row>\r\n      <el-row :gutter=\"10\">\r\n        <el-col :span=\"24\" style=\"text-indent:2em;\">\r\n          {{commentItem.content}}\r\n        </el-col>\r\n        <el-col :span=\"24\" style=\"border-left:2px solid #ccc\">\r\n          <div\r\n            v-for='(sonCommentItem, index) in commentItem.comments'\r\n            :key='index'\r\n            style=\"margin: 20px; border-bottom: 1px dashed #ccc;\"\r\n          >\r\n            <el-row :gutter=\"10\" >\r\n              <el-col :span=\"2\">\r\n                <el-avatar :src='sonCommentItem.userData.avatar'  size='large'></el-avatar>\r\n              </el-col>\r\n              <el-col :span=\"6\" style=\"color:#409EFF;font-size: 12px;\">\r\n                <span>{{sonCommentItem.userData.userName}}</span>\r\n                <br>\r\n                <span>{{sonCommentItem.lastModified | transformTime}}</span>\r\n              </el-col>\r\n              <el-col :span=\"16\" style=\"text-indent:2em;\">\r\n                {{sonCommentItem.content}}\r\n              </el-col>\r\n            </el-row>\r\n          </div>\r\n        </el-col>\r\n      </el-row>\r\n      <el-row :gutter=\"10\">\r\n        <el-col :span=\"6\">\r\n          <el-button type=\"text\" icon=\"el-icon-s-comment\" @click='switchComment(commentItem)'>回复</el-button>\r\n        </el-col>\r\n      </el-row>\r\n      <el-row :gutter='10' v-if='commentItem.isComment'>\r\n        <el-col :span=\"24\">\r\n          <el-input v-model='commentStr' placeholder=\"说点什么吧~\"></el-input>\r\n        </el-col>\r\n        <el-col :span=\"24\" style=\"text-align: right; margin-top: 10px;\">\r\n          <el-button type='primary' size=\"mini\" @click='cancelComment(commentItem,\"son\")'>取消</el-button>\r\n          <el-button type='primary' size=\"mini\" @click='addComment(commentItem,\"son\")'>回复</el-button>\r\n        </el-col>\r\n      </el-row>\r\n    </div>\r\n    <el-row :gutter='10' v-if='isComment'>\r\n      <el-col :span=\"24\">\r\n        <el-input v-model='articleCommentStr' placeholder=\"说点什么吧~\"></el-input>\r\n      </el-col>\r\n      <el-col :span=\"24\" style=\"text-align: right; margin-top: 10px;\">\r\n        <el-button type='primary' size=\"mini\" @click='cancelComment(localComment,\"father\")'>取消</el-button>\r\n        <el-button type='primary' size=\"mini\" @click='addComment(localComment,\"father\")'>回复</el-button>\r\n      </el-col>\r\n    </el-row>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import BlogService from '@/service/BlogService'\r\n  export default {\r\n    name: \"GlobalComment\",\r\n    props:{\r\n      blogId:{\r\n        type:Number,\r\n        default:0\r\n      },\r\n      comments:{\r\n        type:Array,\r\n        default(){\r\n          return []\r\n        }\r\n      }\r\n    },\r\n    watch:{\r\n      comments:{\r\n        handler(){\r\n          this.localComment = this.comments.slice(0)\r\n        },\r\n        immediate:true\r\n      }\r\n    },\r\n    data(){\r\n      return {\r\n        articleCommentStr:'',\r\n        commentStr:'',\r\n        localComment:[],\r\n        isComment:true,\r\n        userData:JSON.parse(sessionStorage.getItem('userData')),\r\n\r\n      }\r\n    },\r\n    filters:{\r\n      transformTime(time){\r\n        let blogCreateTime = new Date(time)\r\n        let currentTime = new Date()\r\n        let offsetTime = currentTime - blogCreateTime\r\n        let offsetST = offsetTime / 1000\r\n        let offsetMT = offsetST / 60\r\n        let offsetHT = offsetMT / 60\r\n        let offsetDT = offsetHT / 24\r\n        if(offsetDT >= 365){\r\n          return `发表于 ${Math.floor(offsetDT / 365)} 年之前`\r\n        }else if(offsetDT >= 30){\r\n          return `发表于 ${Math.floor(offsetDT / 30)} 个月之前`\r\n        }else if(offsetDT >= 7){\r\n          return `发表于 ${Math.floor(offsetDT / 7)} 周之前`\r\n        }else if(offsetDT >= 1){\r\n          return `发表于 ${Math.floor(offsetDT)} 天之前`\r\n        }else if(offsetHT >= 1){\r\n          return `发表于 ${Math.floor(offsetHT)} 小时之前`\r\n        }\r\n        else if(offsetMT >= 1){\r\n          return `发表于 ${Math.floor(offsetMT)} 分钟之前`\r\n        }\r\n        else if(offsetST >= 0){\r\n          // return `发表于 ${Math.floor(offsetST)} 秒钟之前`\r\n          return '刚刚'\r\n        }\r\n      }\r\n    },\r\n    methods:{\r\n      switchComment(commentItem){\r\n        this.localComment.forEach(item => {\r\n          if(item != commentItem){\r\n            item.isComment = false\r\n          }\r\n        })\r\n        commentItem.isComment = !commentItem.isComment\r\n          if(!commentItem.isComment){\r\n            this.isComment = true\r\n          }else{\r\n            this.isComment = false\r\n          }\r\n      },\r\n      cancelComment(target,type){\r\n        switch(type){\r\n          case 'father':\r\n            this.articleCommentStr = ''\r\n            break;\r\n          case 'son':\r\n            this.commentStr = ''\r\n            target.isComment = false\r\n            this.isComment = true\r\n            break;\r\n        }\r\n      },\r\n      addComment(target, type){\r\n        let commentData = {\r\n          fatherId:'',\r\n          blogId:this.blogId,\r\n          comment:{}\r\n        }\r\n        switch(type){\r\n          case 'father':\r\n            commentData.comment = {\r\n              userData:{\r\n                userName:this.userData.userName,\r\n                avatar:this.userData.avatar\r\n              },\r\n              content:this.articleCommentStr,\r\n              isComment:false,\r\n              comments:[]\r\n            }\r\n            this.articleCommentStr = ''\r\n            break;\r\n          case 'son':\r\n            commentData.fatherId = target.commentId\r\n            commentData.comment = {\r\n              userData:{\r\n                userName:this.userData.userName,\r\n                avatar:this.userData.avatar\r\n              },\r\n              content:this.commentStr,\r\n            }\r\n            this.commentStr = ''\r\n            target.isComment = false\r\n            this.isComment = true\r\n            break;\r\n        }\r\n        BlogService.createBlogComment(commentData).then(res => {\r\n          if(res.data.status === 200){\r\n            switch(type){\r\n              case 'father':\r\n                target.push(res.data.data.commentData)\r\n                break;\r\n              case 'son':\r\n                target.comments.push(res.data.data.commentData)\r\n                break;\r\n            }\r\n            this.$message.success(res.data.message)\r\n          }else{\r\n            this.$message.err(res.message)\r\n          }\r\n        })\r\n\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n  .comment-card{\r\n    padding:20px;\r\n    box-shadow: 0 2px 4px rgba(0,0,0,.5);\r\n  }\r\n</style>"]}]}