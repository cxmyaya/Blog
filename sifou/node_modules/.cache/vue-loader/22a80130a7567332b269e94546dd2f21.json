{"remainingRequest":"E:\\丫丫\\web\\CODE\\blog\\sifou\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\丫丫\\web\\CODE\\blog\\sifou\\src\\pages\\admin\\views\\Permission.vue?vue&type=style&index=0&id=90aa68d6&scoped=true&lang=css&","dependencies":[{"path":"E:\\丫丫\\web\\CODE\\blog\\sifou\\src\\pages\\admin\\views\\Permission.vue","mtime":1612172873023},{"path":"E:\\丫丫\\web\\CODE\\blog\\sifou\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\丫丫\\web\\CODE\\blog\\sifou\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\丫丫\\web\\CODE\\blog\\sifou\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"E:\\丫丫\\web\\CODE\\blog\\sifou\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\丫丫\\web\\CODE\\blog\\sifou\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgovZGVlcC8gLmVsLXBhZ2luYXRpb257CiAgdGV4dC1hbGlnbjogcmlnaHQ7Cn0K"},{"version":3,"sources":["Permission.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsIA;AACA;AACA","file":"Permission.vue","sourceRoot":"src/pages/admin/views","sourcesContent":["<template>\r\n  <div>\r\n    <el-table :data=\"userList\" size='mini'>\r\n      <el-table-column prop=\"userName\" label='用户名' align=\"center\"></el-table-column>\r\n      <el-table-column prop=\"avatar\" label='头像' align=\"center\">\r\n        <template slot-scope='scope'>\r\n            <el-avatar :src='scope.row.avatar'></el-avatar>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column prop=\"introduction\" label='简介' align=\"center\"></el-table-column>\r\n      <el-table-column  prop=\"approved\" label='是否冻结账号' align=\"center\">\r\n        <template slot-scope='scope'>\r\n          <el-switch :value=\"!scope.row.approved\" @change=\"switchApproved(scope.row)\"></el-switch>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column  prop=\"isAdmin\" label='是否设置为管理员' align=\"center\">\r\n        <template slot-scope='scope'>\r\n          <el-switch v-model=\"scope.row.isAdmin\" @change=\"switchAdmin(scope.row)\"></el-switch>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label='操作' align=\"center\">\r\n        <template slot-scope='scope'>\r\n          <el-button type=\"danger\" size=\"mini\" @click='rejectedUser(scope.row)'>删除</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <el-pagination\r\n      layout='prev, pager, next'\r\n      :total='total'\r\n      @current-change=\"handleCurrentChange\"\r\n      :current-page.sync=\"searchParams.pageNum\"\r\n    >\r\n    </el-pagination>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import AuthorService from '@/service/AuthorService'\r\n  export default {\r\n    name: \"Permission\",\r\n    data(){\r\n      return {\r\n        searchParams:{\r\n          pageNum:1,\r\n          limit:10\r\n        },\r\n        total:0,\r\n        userList:[]\r\n      }\r\n    },\r\n    mounted(){\r\n      this.getUserList()\r\n    },\r\n    methods:{\r\n      getUserList(){\r\n        AuthorService.getAllUser(this.searchParams).then(res => {\r\n          if(res.data.status === 200){\r\n            this.total = res.data.data.total\r\n            this.userList = res.data.data.userList\r\n          }else{\r\n            this.$message.error(res.data.message)\r\n          }\r\n        })\r\n      },\r\n      handleCurrentChange(val){\r\n        this.searchParams.pageNum = val\r\n        this.getUserList()\r\n      },\r\n      switchAdmin(row){\r\n        if(!row.approved){\r\n          row.isAdmin = !row.isAdmin\r\n          this.$message.warning('该用户账号还未通过审核')\r\n          return\r\n        }\r\n        this.$confirm('确定更改该用户的管理员权限吗？','警告',{\r\n          confirmButtonText: '确定',\r\n          cancelButtonText: '取消',\r\n          type: 'warning'\r\n        }).then(() => {\r\n          AuthorService.setAdmin({key:row.key, isAdmin:row.isAdmin}).then(res => {\r\n            if(res.data.status == 200){\r\n              this.$message.success(res.data.message)\r\n            }\r\n          })\r\n        }).catch(() => {\r\n          row.isAdmin = !row.isAdmin\r\n          this.$message.info('已取消更改用户管理权限')\r\n        })\r\n      },\r\n      switchApproved(row){\r\n        row.approved = !row.approved\r\n        this.$confirm('确定更改该用户的账号状态吗？','警告',{\r\n          confirmButtonText: '确定',\r\n          cancelButtonText: '取消',\r\n          type: 'warning'\r\n        }).then(() => {\r\n          AuthorService.setApproved({key:row.key, approved:row.approved}).then(res => {\r\n            if(res.data.status == 200){\r\n              this.$message.success(res.data.message)\r\n            }\r\n          })\r\n        }).catch(() => {\r\n          row.approved = !row.approved\r\n          this.$message.info('已取消更改用户账号状态')\r\n        })\r\n      },\r\n      rejectedUser(row){\r\n        this.$confirm('此操作将永久删除该用户及其所有文章, 是否继续?', '提示', {\r\n          confirmButtonText: '确定',\r\n          cancelButtonText: '取消',\r\n          type: 'warning'\r\n        }).then(() => {\r\n          AuthorService.deleteUser({key:row.key}).then(res => {\r\n          if(res.data.status === 200){\r\n            this.$message.success(res.data.message)\r\n            this.searchUserParams.pageNum = 1\r\n            this.getUserList()\r\n          }else{\r\n            this.$message.error(res.data.message)\r\n          }\r\n        })\r\n        }).catch(() => {\r\n          this.$message({\r\n            type: 'info',\r\n            message: '已取消删除'\r\n          });          \r\n        });\r\n        \r\n      },\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n  /deep/ .el-pagination{\r\n    text-align: right;\r\n  }\r\n</style>"]}]}