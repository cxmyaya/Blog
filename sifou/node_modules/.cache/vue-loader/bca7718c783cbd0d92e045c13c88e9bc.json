{"remainingRequest":"E:\\丫丫\\web\\CODE\\blog\\sifou\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\丫丫\\web\\CODE\\blog\\sifou\\src\\pages\\admin\\views\\Permission.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\丫丫\\web\\CODE\\blog\\sifou\\src\\pages\\admin\\views\\Permission.vue","mtime":1612172873023},{"path":"E:\\丫丫\\web\\CODE\\blog\\sifou\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\丫丫\\web\\CODE\\blog\\sifou\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\丫丫\\web\\CODE\\blog\\sifou\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\丫丫\\web\\CODE\\blog\\sifou\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBBdXRob3JTZXJ2aWNlIGZyb20gJ0Avc2VydmljZS9BdXRob3JTZXJ2aWNlJwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIlBlcm1pc3Npb24iLAogIGRhdGEoKXsKICAgIHJldHVybiB7CiAgICAgIHNlYXJjaFBhcmFtczp7CiAgICAgICAgcGFnZU51bToxLAogICAgICAgIGxpbWl0OjEwCiAgICAgIH0sCiAgICAgIHRvdGFsOjAsCiAgICAgIHVzZXJMaXN0OltdCiAgICB9CiAgfSwKICBtb3VudGVkKCl7CiAgICB0aGlzLmdldFVzZXJMaXN0KCkKICB9LAogIG1ldGhvZHM6ewogICAgZ2V0VXNlckxpc3QoKXsKICAgICAgQXV0aG9yU2VydmljZS5nZXRBbGxVc2VyKHRoaXMuc2VhcmNoUGFyYW1zKS50aGVuKHJlcyA9PiB7CiAgICAgICAgaWYocmVzLmRhdGEuc3RhdHVzID09PSAyMDApewogICAgICAgICAgdGhpcy50b3RhbCA9IHJlcy5kYXRhLmRhdGEudG90YWwKICAgICAgICAgIHRoaXMudXNlckxpc3QgPSByZXMuZGF0YS5kYXRhLnVzZXJMaXN0CiAgICAgICAgfWVsc2V7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHJlcy5kYXRhLm1lc3NhZ2UpCiAgICAgICAgfQogICAgICB9KQogICAgfSwKICAgIGhhbmRsZUN1cnJlbnRDaGFuZ2UodmFsKXsKICAgICAgdGhpcy5zZWFyY2hQYXJhbXMucGFnZU51bSA9IHZhbAogICAgICB0aGlzLmdldFVzZXJMaXN0KCkKICAgIH0sCiAgICBzd2l0Y2hBZG1pbihyb3cpewogICAgICBpZighcm93LmFwcHJvdmVkKXsKICAgICAgICByb3cuaXNBZG1pbiA9ICFyb3cuaXNBZG1pbgogICAgICAgIHRoaXMuJG1lc3NhZ2Uud2FybmluZygn6K+l55So5oi36LSm5Y+36L+Y5pyq6YCa6L+H5a6h5qC4JykKICAgICAgICByZXR1cm4KICAgICAgfQogICAgICB0aGlzLiRjb25maXJtKCfnoa7lrprmm7TmlLnor6XnlKjmiLfnmoTnrqHnkIblkZjmnYPpmZDlkJfvvJ8nLCforablkYonLHsKICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+ehruWumicsCiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+WPlua2iCcsCiAgICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICAgIH0pLnRoZW4oKCkgPT4gewogICAgICAgIEF1dGhvclNlcnZpY2Uuc2V0QWRtaW4oe2tleTpyb3cua2V5LCBpc0FkbWluOnJvdy5pc0FkbWlufSkudGhlbihyZXMgPT4gewogICAgICAgICAgaWYocmVzLmRhdGEuc3RhdHVzID09IDIwMCl7CiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2VzcyhyZXMuZGF0YS5tZXNzYWdlKQogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgIH0pLmNhdGNoKCgpID0+IHsKICAgICAgICByb3cuaXNBZG1pbiA9ICFyb3cuaXNBZG1pbgogICAgICAgIHRoaXMuJG1lc3NhZ2UuaW5mbygn5bey5Y+W5raI5pu05pS555So5oi3566h55CG5p2D6ZmQJykKICAgICAgfSkKICAgIH0sCiAgICBzd2l0Y2hBcHByb3ZlZChyb3cpewogICAgICByb3cuYXBwcm92ZWQgPSAhcm93LmFwcHJvdmVkCiAgICAgIHRoaXMuJGNvbmZpcm0oJ+ehruWumuabtOaUueivpeeUqOaIt+eahOi0puWPt+eKtuaAgeWQl++8nycsJ+itpuWRiicsewogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn56Gu5a6aJywKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn5Y+W5raIJywKICAgICAgICB0eXBlOiAnd2FybmluZycKICAgICAgfSkudGhlbigoKSA9PiB7CiAgICAgICAgQXV0aG9yU2VydmljZS5zZXRBcHByb3ZlZCh7a2V5OnJvdy5rZXksIGFwcHJvdmVkOnJvdy5hcHByb3ZlZH0pLnRoZW4ocmVzID0+IHsKICAgICAgICAgIGlmKHJlcy5kYXRhLnN0YXR1cyA9PSAyMDApewogICAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MocmVzLmRhdGEubWVzc2FnZSkKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICB9KS5jYXRjaCgoKSA9PiB7CiAgICAgICAgcm93LmFwcHJvdmVkID0gIXJvdy5hcHByb3ZlZAogICAgICAgIHRoaXMuJG1lc3NhZ2UuaW5mbygn5bey5Y+W5raI5pu05pS555So5oi36LSm5Y+354q25oCBJykKICAgICAgfSkKICAgIH0sCiAgICByZWplY3RlZFVzZXIocm93KXsKICAgICAgdGhpcy4kY29uZmlybSgn5q2k5pON5L2c5bCG5rC45LmF5Yig6Zmk6K+l55So5oi35Y+K5YW25omA5pyJ5paH56ugLCDmmK/lkKbnu6fnu60/JywgJ+aPkOekuicsIHsKICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+ehruWumicsCiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+WPlua2iCcsCiAgICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICAgIH0pLnRoZW4oKCkgPT4gewogICAgICAgIEF1dGhvclNlcnZpY2UuZGVsZXRlVXNlcih7a2V5OnJvdy5rZXl9KS50aGVuKHJlcyA9PiB7CiAgICAgICAgaWYocmVzLmRhdGEuc3RhdHVzID09PSAyMDApewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKHJlcy5kYXRhLm1lc3NhZ2UpCiAgICAgICAgICB0aGlzLnNlYXJjaFVzZXJQYXJhbXMucGFnZU51bSA9IDEKICAgICAgICAgIHRoaXMuZ2V0VXNlckxpc3QoKQogICAgICAgIH1lbHNlewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihyZXMuZGF0YS5tZXNzYWdlKQogICAgICAgIH0KICAgICAgfSkKICAgICAgfSkuY2F0Y2goKCkgPT4gewogICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgdHlwZTogJ2luZm8nLAogICAgICAgICAgbWVzc2FnZTogJ+W3suWPlua2iOWIoOmZpCcKICAgICAgICB9KTsgICAgICAgICAgCiAgICAgIH0pOwogICAgICAKICAgIH0sCiAgfQp9Cg=="},{"version":3,"sources":["Permission.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"Permission.vue","sourceRoot":"src/pages/admin/views","sourcesContent":["<template>\r\n  <div>\r\n    <el-table :data=\"userList\" size='mini'>\r\n      <el-table-column prop=\"userName\" label='用户名' align=\"center\"></el-table-column>\r\n      <el-table-column prop=\"avatar\" label='头像' align=\"center\">\r\n        <template slot-scope='scope'>\r\n            <el-avatar :src='scope.row.avatar'></el-avatar>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column prop=\"introduction\" label='简介' align=\"center\"></el-table-column>\r\n      <el-table-column  prop=\"approved\" label='是否冻结账号' align=\"center\">\r\n        <template slot-scope='scope'>\r\n          <el-switch :value=\"!scope.row.approved\" @change=\"switchApproved(scope.row)\"></el-switch>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column  prop=\"isAdmin\" label='是否设置为管理员' align=\"center\">\r\n        <template slot-scope='scope'>\r\n          <el-switch v-model=\"scope.row.isAdmin\" @change=\"switchAdmin(scope.row)\"></el-switch>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label='操作' align=\"center\">\r\n        <template slot-scope='scope'>\r\n          <el-button type=\"danger\" size=\"mini\" @click='rejectedUser(scope.row)'>删除</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <el-pagination\r\n      layout='prev, pager, next'\r\n      :total='total'\r\n      @current-change=\"handleCurrentChange\"\r\n      :current-page.sync=\"searchParams.pageNum\"\r\n    >\r\n    </el-pagination>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import AuthorService from '@/service/AuthorService'\r\n  export default {\r\n    name: \"Permission\",\r\n    data(){\r\n      return {\r\n        searchParams:{\r\n          pageNum:1,\r\n          limit:10\r\n        },\r\n        total:0,\r\n        userList:[]\r\n      }\r\n    },\r\n    mounted(){\r\n      this.getUserList()\r\n    },\r\n    methods:{\r\n      getUserList(){\r\n        AuthorService.getAllUser(this.searchParams).then(res => {\r\n          if(res.data.status === 200){\r\n            this.total = res.data.data.total\r\n            this.userList = res.data.data.userList\r\n          }else{\r\n            this.$message.error(res.data.message)\r\n          }\r\n        })\r\n      },\r\n      handleCurrentChange(val){\r\n        this.searchParams.pageNum = val\r\n        this.getUserList()\r\n      },\r\n      switchAdmin(row){\r\n        if(!row.approved){\r\n          row.isAdmin = !row.isAdmin\r\n          this.$message.warning('该用户账号还未通过审核')\r\n          return\r\n        }\r\n        this.$confirm('确定更改该用户的管理员权限吗？','警告',{\r\n          confirmButtonText: '确定',\r\n          cancelButtonText: '取消',\r\n          type: 'warning'\r\n        }).then(() => {\r\n          AuthorService.setAdmin({key:row.key, isAdmin:row.isAdmin}).then(res => {\r\n            if(res.data.status == 200){\r\n              this.$message.success(res.data.message)\r\n            }\r\n          })\r\n        }).catch(() => {\r\n          row.isAdmin = !row.isAdmin\r\n          this.$message.info('已取消更改用户管理权限')\r\n        })\r\n      },\r\n      switchApproved(row){\r\n        row.approved = !row.approved\r\n        this.$confirm('确定更改该用户的账号状态吗？','警告',{\r\n          confirmButtonText: '确定',\r\n          cancelButtonText: '取消',\r\n          type: 'warning'\r\n        }).then(() => {\r\n          AuthorService.setApproved({key:row.key, approved:row.approved}).then(res => {\r\n            if(res.data.status == 200){\r\n              this.$message.success(res.data.message)\r\n            }\r\n          })\r\n        }).catch(() => {\r\n          row.approved = !row.approved\r\n          this.$message.info('已取消更改用户账号状态')\r\n        })\r\n      },\r\n      rejectedUser(row){\r\n        this.$confirm('此操作将永久删除该用户及其所有文章, 是否继续?', '提示', {\r\n          confirmButtonText: '确定',\r\n          cancelButtonText: '取消',\r\n          type: 'warning'\r\n        }).then(() => {\r\n          AuthorService.deleteUser({key:row.key}).then(res => {\r\n          if(res.data.status === 200){\r\n            this.$message.success(res.data.message)\r\n            this.searchUserParams.pageNum = 1\r\n            this.getUserList()\r\n          }else{\r\n            this.$message.error(res.data.message)\r\n          }\r\n        })\r\n        }).catch(() => {\r\n          this.$message({\r\n            type: 'info',\r\n            message: '已取消删除'\r\n          });          \r\n        });\r\n        \r\n      },\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n  /deep/ .el-pagination{\r\n    text-align: right;\r\n  }\r\n</style>"]}]}