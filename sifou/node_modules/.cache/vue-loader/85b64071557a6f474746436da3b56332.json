{"remainingRequest":"E:\\丫丫\\web\\CODE\\blog\\sifou\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\丫丫\\web\\CODE\\blog\\sifou\\src\\components\\ArticleDetail.vue?vue&type=style&index=0&id=186707a2&scoped=true&lang=css&","dependencies":[{"path":"E:\\丫丫\\web\\CODE\\blog\\sifou\\src\\components\\ArticleDetail.vue","mtime":1612165502121},{"path":"E:\\丫丫\\web\\CODE\\blog\\sifou\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\丫丫\\web\\CODE\\blog\\sifou\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\丫丫\\web\\CODE\\blog\\sifou\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"E:\\丫丫\\web\\CODE\\blog\\sifou\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\丫丫\\web\\CODE\\blog\\sifou\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5jbGVhcmZpeDpiZWZvcmUsCi5jbGVhcmZpeDphZnRlciB7CiAgZGlzcGxheTogdGFibGU7CiAgY29udGVudDogIiI7Cn0KLmNsZWFyZml4OmFmdGVyIHsKICBjbGVhcjogYm90aAp9Cg=="},{"version":3,"sources":["ArticleDetail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0PA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ArticleDetail.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <div style=\"padding:20px\">\r\n    <el-page-header @back='goBack' :content='blogData.title'></el-page-header>\r\n    <el-card class=\"box-card\" style=\"margin-top:20px\">\r\n      <div slot=\"header\" class=\"clearfix\">\r\n        <el-row>\r\n          <el-col :span=\"1\">\r\n            <el-avatar\r\n              :src='blogData.author.avatar'\r\n            >\r\n\r\n            </el-avatar>\r\n          </el-col>\r\n          <el-col :span=\"6\">\r\n            <span>{{blogData.author.userName}}</span>\r\n            <br>\r\n            <span>{{blogData.lastModified | transformTime}}</span>\r\n          </el-col>\r\n          <el-col :span=\"8\" :offset='8'>\r\n            <el-button\r\n             type=\"warning\" \r\n             circle \r\n             :icon=\"userData.userDetail.likes.includes(blogId) ? 'el-icon-star-on' :'el-icon-star-off '\" \r\n             size='medium'\r\n             @click='switchLike'\r\n             >\r\n            </el-button>\r\n            <el-button\r\n              v-if='!(blogData.author.userName === userData.userName)'\r\n              type=\"primary\"\r\n              :icon=\"userData.userDetail.attentions.includes(blogData.author.userName) ? 'el-icon-check' :'el-icon-plus '\" \r\n              size='medium'\r\n              @click='switchAttention'>\r\n               关注\r\n            </el-button>\r\n            <el-button \r\n              v-if='!(blogData.author.userName === userData.userName)'\r\n              type=\"danger\"\r\n              icon=\"el-icon-s-custom\" \r\n              size='medium'\r\n              @click='switchBlackList'>\r\n              {{userData.userDetail.blackList.includes(blogData.author.userName) ? '已拉黑':'拉黑'}}\r\n            </el-button>\r\n            <el-button \r\n            v-if='!(blogData.author.userName === userData.userName)' \r\n            type=\"danger\"\r\n            icon=\"el-icon-thumb\"\r\n            size='medium'\r\n            @click='switchTipOff'>举报</el-button>\r\n          </el-col>\r\n        </el-row>\r\n      </div>\r\n      <div> \r\n        <div class=\"main\" v-html='blogData.content'></div>\r\n        <div>\r\n          <el-tag v-for='(tag,index) in blogData.tags' :key='index' style='margin-right:20px' type=\"success\">{{tag}}</el-tag>\r\n        </div>\r\n        <div style=\"margin-top: 20px;\">\r\n          <el-row>\r\n            <el-col :span=\"1\"><i class=\"el-icon-star-on\"></i>{{blogData.likes}}</el-col>\r\n            <el-col :span=\"1\"><i class=\"el-icon-view\"></i>{{blogData.views}}</el-col>\r\n            <el-col :span=\"1\"><i class=\"el-icon-s-comment\"></i>{{blogData.comments.length}}</el-col>\r\n          </el-row>\r\n        </div>\r\n      </div>\r\n      <el-divider><i class=\"el-icon-s-comment\"></i></el-divider>\r\n      <GlobalComment :blogId='blogId' :comments=\"blogData.comments\"></GlobalComment>\r\n    </el-card>\r\n    <el-dialog\r\n      title=\"举报文章\"\r\n      :visible.sync = 'isShowTipOff'\r\n      width=30%>\r\n      <el-input v-model='tipOffReason' placeholder=\"举报原因\" type=\"textarea\"></el-input>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click='isShowTipOff = false'>取消</el-button>\r\n        <el-button @click='switchTipOff' type=\"primary\">确定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </div>\r\n  \r\n</template>\r\n\r\n<script>\r\n  import BlogService from '@/service/BlogService'\r\n  import UserDetailService from '@/service/UserDetailService'\r\n  import TipOffService from '@/service/TipOffService'\r\n  import GlobalComment from '@/components/Global-Comment'\r\n  export default {\r\n    name: \"articleDetail\",\r\n    components:{\r\n      GlobalComment\r\n    },\r\n    data(){\r\n      return {\r\n        blogId:'',\r\n        blogData:{\r\n          author:{\r\n            userName:'',\r\n            avatar:''\r\n          },\r\n          lastModified:'',\r\n          content:'',\r\n          comments:[],\r\n          likes:'',\r\n          views:''\r\n        },\r\n        userData:{},\r\n        tipOffReason:'',\r\n        isShowTipOff:false\r\n      }\r\n    },\r\n    created(){\r\n      this.blogId = Number(this.$route.params.id)\r\n      this.userData = JSON.parse(sessionStorage.getItem('userData'))\r\n    },\r\n    mounted(){\r\n      this.getBlogById(1)\r\n    },\r\n    filters:{\r\n      transformTime(time){\r\n        let blogCreateTime = new Date(time)\r\n        let currentTime = new Date()\r\n        let offsetTime = currentTime - blogCreateTime\r\n        let offsetST = offsetTime / 1000\r\n        let offsetMT = offsetST / 60\r\n        let offsetHT = offsetMT / 60\r\n        let offsetDT = offsetHT / 24\r\n        if(offsetDT >= 365){\r\n          return `发表于 ${Math.floor(offsetDT / 365)} 年之前`\r\n        }else if(offsetDT >= 30){\r\n          return `发表于 ${Math.floor(offsetDT / 30)} 个月之前`\r\n        }else if(offsetDT >= 7){\r\n          return `发表于 ${Math.floor(offsetDT / 7)} 周之前`\r\n        }else if(offsetDT >= 1){\r\n          return `发表于 ${Math.floor(offsetDT)} 天之前`\r\n        }else if(offsetHT >= 1){\r\n          return `发表于 ${Math.floor(offsetHT)} 小时之前`\r\n        }\r\n        else if(offsetMT >= 1){\r\n          return `发表于 ${Math.floor(offsetMT)} 分钟之前`\r\n        }\r\n        else if(offsetST >= 1){\r\n          return `发表于 ${Math.floor(offsetST)} 秒钟之前`\r\n        }\r\n      }\r\n    },\r\n    methods:{\r\n      getBlogById(firstView){\r\n        BlogService.getBlogById({blogId:this.blogId,firstView}).then(res => {\r\n          if(res.data.status === 200){\r\n            this.blogData = res.data.data.blogData\r\n          }\r\n        })\r\n      },\r\n      goBack(){\r\n        this.$router.go(-1)\r\n      },\r\n      switchLike(){\r\n        if(this.userData.userDetail.likes.includes(this.blogId)){\r\n          //取消点赞\r\n          UserDetailService.deleteLike({blogId:this.blogId}).then(res => {\r\n            if(res.data.status === 200){\r\n              this.userData.userDetail.likes.splice(this.userData.userDetail.likes.indexOf(this.blogId),1)\r\n              sessionStorage.setItem('userData',JSON.stringify(this.userData))\r\n              this.getBlogById(0)\r\n            }\r\n            this.$message.success(res.data.message)\r\n          })\r\n        }else{\r\n          //点赞\r\n          UserDetailService.setLike({blogId:this.blogId}).then(res => {\r\n            if(res.data.status === 200){\r\n              this.userData.userDetail.likes.push(this.blogId)\r\n              sessionStorage.setItem('userData',JSON.stringify(this.userData))\r\n              this.getBlogById(0)\r\n            }\r\n            this.$message.success(res.data.message)\r\n          })\r\n        }\r\n      },\r\n      switchAttention(){\r\n        if(this.userData.userDetail.attentions.includes(this.blogData.author.userName)){\r\n          //取消关注\r\n          UserDetailService.deleteAttention({userName:this.blogData.author.userName}).then(res => {\r\n            if(res.data.status === 200){\r\n              this.userData.userDetail.attentions.splice(this.userData.userDetail.attentions.indexOf(this.blogId),1)\r\n              sessionStorage.setItem('userData',JSON.stringify(this.userData))\r\n              // this.getBlogById(0)\r\n            }\r\n            this.$message.success(res.data.message)\r\n          })\r\n        }else{\r\n          //关注\r\n          UserDetailService.setAttention({userName:this.blogData.author.userName}).then(res => {\r\n            if(res.data.status === 200){\r\n              this.userData.userDetail.attentions.push(this.blogData.author.userName)\r\n              sessionStorage.setItem('userData',JSON.stringify(this.userData))\r\n              // this.getBlogById(0)\r\n            }\r\n            this.$message.success(res.data.message)\r\n          })\r\n        }\r\n      },\r\n      switchBlackList(){\r\n        if(this.userData.userDetail.blackList.includes(this.blogData.author.userName)){\r\n          //取消拉黑\r\n          UserDetailService.deleteBlackList({userName:this.blogData.author.userName}).then(res => {\r\n            if(res.data.status === 200){\r\n              this.userData.userDetail.blackList.splice(this.userData.userDetail.blackList.indexOf(this.blogId),1)\r\n              sessionStorage.setItem('userData',JSON.stringify(this.userData))\r\n              // this.getBlogById(0)\r\n            }\r\n            this.$message.success(res.data.message)\r\n          })\r\n        }else{\r\n          //拉黑\r\n          UserDetailService.setBlackList({userName:this.blogData.author.userName}).then(res => {\r\n            if(res.data.status === 200){\r\n              this.userData.userDetail.blackList.push(this.blogData.author.userName)\r\n              sessionStorage.setItem('userData',JSON.stringify(this.userData))\r\n              // this.getBlogById(0)\r\n            }\r\n            this.$message.success(res.data.message)\r\n          })\r\n        }\r\n      },\r\n      switchTipOff(){\r\n        this.isShowTipOff = !this.isShowTipOff\r\n        if(!this.isShowTipOff){\r\n          let data = {\r\n            blogId:this.blogId,\r\n            description:this.blogData.description,\r\n            cover:this.blogData.cover,\r\n            title:this.blogData.title,\r\n            reason:this.tipOffReason\r\n          }\r\n          TipOffService.tipOffArticle(data).then(res => {\r\n            if(res.data.status === 200){\r\n              this.$message.success(res.data.message)\r\n            }else{\r\n              this.$message.error(res.data.message)\r\n            }\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n  .clearfix:before,\r\n  .clearfix:after {\r\n    display: table;\r\n    content: \"\";\r\n  }\r\n  .clearfix:after {\r\n    clear: both\r\n  }\r\n</style>"]}]}